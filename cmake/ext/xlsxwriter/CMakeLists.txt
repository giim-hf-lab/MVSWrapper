set(USE_STANDARD_TMPFILE ON)

FetchContent_Declare(xlsxwriter
	GIT_REPOSITORY "$CACHE{__C_GITHUB_PREFIX}jmcnamara/libxlsxwriter.git"
	GIT_TAG "RELEASE_$CACHE{__C_XLSXWRITER_VERSION}"
	GIT_SUBMODULES_RECURSE TRUE
	GIT_SHALLOW "${__G_FETCHCONTENT_GIT_SHALLOW}"
	GIT_REMOTE_UPDATE_STRATEGY CHECKOUT
	OVERRIDE_FIND_PACKAGE
)

find_package(xlsxwriter "$CACHE{__C_XLSXWRITER_VERSION}" REQUIRED GLOBAL)

set_property(
	TARGET
		xlsxwriter
	PROPERTY SYSTEM TRUE
)

add_library(xlsxwriter::xlsxwriter ALIAS xlsxwriter)
